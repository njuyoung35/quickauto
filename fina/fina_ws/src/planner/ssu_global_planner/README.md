---
marp: true
paginate: true
theme: default
---

# SSU Global Planner

### Lanelet2 + RViz 기반 전역 경로 생성기

패키지명: ssu_global_planner\
담당: 글로벌 플래너 파트 단독 구현

------------------------------------------------------------------------

## 1. 담당 범위

-   전체 자율주행 시스템 중 **글로벌 플래너 파트만 단독 담당**
-   전역 경로 생성 전 과정 직접 구현

------------------------------------------------------------------------

## 2. 글로벌 플래너의 역할

-   RViz에서 시작점과 도착점 입력 수신
-   Map 좌표 → 위경도(lat, lon) 변환
-   Lanelet2 OSM 기반 도로 그래프 생성
-   Dijkstra 알고리즘 기반 최단 전역 경로 탐색
-   `/global_waypoints` 토픽으로 전역 경로 발행

------------------------------------------------------------------------

## 3. 입력 토픽 (RViz 연동)

  구분     토픽 이름        메시지 타입
  -------- ---------------- -----------------------------------------
  시작점   `/initialpose`   geometry_msgs/PoseWithCovarianceStamped
  도착점   `/goal_pose`     geometry_msgs/PoseStamped

-   RViz의 **2D Pose Estimate**, **2D Nav Goal** 기능을 통해 직접 지정

------------------------------------------------------------------------

## 4. 출력 토픽

  --------------------------------------------------------------------------------
  토픽 이름                          메시지 타입                    설명
  ---------------------------------- ------------------------------ --------------
  `/global_waypoints`                nav_msgs/Path                  최단 전역 주행
                                                                    경로

  `/global_waypoints/lanelet_info`   사용자 정의 메시지             경로에 포함된
                                                                    Lanelet ID
                                                                    정보
  --------------------------------------------------------------------------------

------------------------------------------------------------------------

## 5. 사용 지도 정보

-   지도 형식: Lanelet2 기반 OSM
-   사용 파일 경로:

```{=html}
<!-- -->
```
    ssu2_ws/assets/sample-map-planning/lanelet2_map.osm

-   `<node>`: 위경도(lat, lon)
-   `<way>`: 차선 연결 정보
-   `<relation>`: Lanelet 구성 정보

------------------------------------------------------------------------

## 6. 전체 처리 흐름

    RViz
     ↓
    /initialpose   /goal_pose
     ↓
    ssu_global_planner
     ↓
    Lanelet2 OSM 로딩
     ↓
    도로 Graph 생성
     ↓
    Dijkstra 최단 경로 탐색
     ↓
    /global_waypoints 발행

------------------------------------------------------------------------

## 7. Lanelet Graph 구조

``` cpp
struct Node {
  long long id;
  double lat;
  double lon;
  std::vector<long long> neighbors;
};
```

-   Node: 차선 중심점
-   Edge: 차선 연결 관계

------------------------------------------------------------------------

## 8. 최단 경로 탐색 알고리즘

-   Dijkstra 알고리즘 직접 구현
-   Priority Queue 기반 탐색
-   위경도 거리 기반 비용 계산
-   Node ID 기반 최단 경로 리스트 생성

------------------------------------------------------------------------

## 9. RViz 좌표 → 위경도 변환

-   RViz에서 수신한 Pose는 map 좌표계(x, y) 기준
-   OSM의 기준 위경도(Lat0, Lon0)를 기준점으로 설정
-   meter → degree 변환 수행
-   변환된 위경도를 기준으로 가장 가까운 Lanelet Node 탐색

------------------------------------------------------------------------

## 10. 실제 실행 로그 예시

    TBA

------------------------------------------------------------------------

## 11. Autoware와의 관계

-   Autoware의 **글로벌 플래닝 구조 아이디어 참고**
-   Lanelet2 기반 경로 생성 개념 차용
-   Graph 생성, Dijkstra 알고리즘, OSM 파싱은 **모두 직접 구현**

------------------------------------------------------------------------

## 12. 담당 기여 요약

-   Lanelet2 OSM 파싱 알고리즘 구현
-   도로 Graph 구조 설계
-   Dijkstra 최단 경로 탐색 알고리즘 구현
-   RViz Pose 연동 및 위경도 변환 처리
-   `/global_waypoints` 전역 경로 토픽 설계 및 발행

------------------------------------------------------------------------

## 13. 핵심 요약 (Summary)

-   RViz 시작/도착 입력 기반 전역 경로 생성
-   Lanelet2 도로 네트워크 기반 Graph 구성
-   Dijkstra 최단 경로 탐색 적용
-   글로벌 플래닝 전체 파이프라인을 단독 구현
