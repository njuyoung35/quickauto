---

# âœ… **Autoware Behavior Path Planner â€” ì™„ë²½ í•´ì„**

Behavior Path Planner(í–‰ë™ ê¸°ë°˜ ê²½ë¡œ í”Œë˜ë„ˆ)ëŠ” **ììœ¨ì£¼í–‰ ì°¨ëŸ‰ì˜ ì•ˆì „ì„ í¬ê²Œ í–¥ìƒ**ì‹œí‚¤ê³ , **ì£¼í–‰ íš¨ìœ¨ì„±ì„ ë†’ì´ë©°**, **êµí†µë²•ê·œ ì¤€ìˆ˜ ê¸°ë°˜ì˜ ì•ˆì •ì ì¸ ê²½ë¡œë¥¼ ê³„íší•˜ëŠ” ëª¨ë“ˆ**ì´ë‹¤.
ì´ ëª¨ë“ˆì€ ìƒí™©ì— ë”°ë¼ **ì°¨ì„  ìœ ì§€, ì°¨ì„  ë³€ê²½, ì¥ì• ë¬¼ íšŒí”¼, ëª©í‘œ ì§€ì  ì ‘ê·¼, ì¶œë°œ/í•©ë¥˜, ì‚¬ì´ë“œ ì‹œí”„íŠ¸** ë“±ì˜ í–‰ë™ì„ ê²°ì •í•˜ê³ , ê·¸ì— ë§ëŠ” **ë¡œì»¬ ê²½ë¡œ(path)** ë¥¼ ìƒì„±í•œë‹¤.

---

# 1. **Behavior Path Plannerì˜ ëª©ì **

Behavior Path PlannerëŠ” ë‹¤ìŒ ì„¸ ê°€ì§€ ëŒ€ëª©ì ì„ ê°€ì§„ë‹¤:

### â‘  **í˜„ì¬ êµí†µ ìƒí™©ì„ ê³ ë ¤í•œ Path ìƒì„±**

* ego ì°¨ëŸ‰ ìƒíƒœ(ìœ„ì¹˜/ì†ë„/ê°€ì†)
* ì£¼ë³€ ì°¨ëŸ‰/ë³´í–‰ì/ì¥ì• ë¬¼
* ë„ë¡œ êµ¬ì¡°(lanelet ì§€ë„)
* ì •ì§€ì„ /ì‹ í˜¸ë“± ~ ê°™ì€ ê·œì¹™
  â†’ ì´ë¥¼ ì¢…í•©í•˜ì—¬ ê°€ì¥ ì•ˆì „í•˜ê³  íš¨ìœ¨ì ì¸ ê²½ë¡œ ìƒì„±

### â‘¡ **Drivable Area(ì£¼í–‰ ê°€ëŠ¥ ì˜ì—­) ìƒì„±**

* ego ì°¨ëŸ‰ì´ ì‹¤ì œë¡œ ì›€ì§ì¼ ìˆ˜ ìˆëŠ” ì˜ì—­ ì •ì˜
* ì¥ì• ë¬¼ íšŒí”¼ ì‹œ ë” ë„“ê²Œ í™•ì¥
* ì°¨ì„  ë‚´ ì£¼í–‰ ì‹œëŠ” lanelet ê²½ê³„ ê¸°ë°˜ìœ¼ë¡œ ì œí•œ

### â‘¢ **Turn Signal(ë°©í–¥ì§€ì‹œë“±) ëª…ë ¹ ìƒì„±**

* ì°¨ì„  ë³€ê²½, íšŒì „, íšŒí”¼ ë“± ìƒí™©ì— ë§ì¶° turn signal ëª…ë ¹ ìƒì„±

---

# 2. **ì„¤ëª… ê¸°ë°˜: ë™ì‘ ë°©ì‹ ìš”ì•½**

Behavior Path PlannerëŠ” ë‹¤ìŒ íë¦„ìœ¼ë¡œ ì‘ë™í•œë‹¤:

1. **ìƒí™© ë¶„ì„**
   â†’ ego ì°¨ëŸ‰ì˜ ìœ„ì¹˜, ì†ë„, ì£¼ë³€ ë¬¼ì²´ ì •ë³´ë¥¼ ì¢…í•©

2. **í–‰ë™ ê²°ì •**
   â†’ ì°¨ì„  ìœ ì§€ / ì°¨ì„  ë³€ê²½ / ì •ì§€ / íšŒí”¼ / í•©ë¥˜ ë“±

3. **ê²½ë¡œ ìƒì„±**
   â†’ constant jerk lateral shift ê¸°ë°˜ì˜ ë§¤ë„ëŸ¬ìš´ lateral ë³€ìœ„ ê³„íšìœ¼ë¡œ
   ìŠ¹ì°¨ê°ê³¼ ì•ˆì „ì„± ë³´ì¥

4. **ì¶©ëŒ ê²€ì‚¬**
   â†’ ìƒì„±ëœ ê²½ë¡œê°€ target objectì™€ ì¶©ëŒ ê°€ëŠ¥í•œì§€ ê²€ì‚¬
   â†’ RSS ê¸°ë°˜ ì•ˆì „ê±°ë¦¬ ê³„ì‚° í¬í•¨

5. **drivable area ìƒì„±**
   â†’ ego ì°¨ëŸ‰ì´ ë²—ì–´ë‚˜ë©´ ì•ˆ ë˜ëŠ” ì˜ì—­ ìƒì„± (static + dynamic)

6. **turn signal ìƒì„±**
   â†’ í•„ìš”í•œ ìƒí™©ì—ì„œ ì¢Œ/ìš°/ë¹„í™œì„± ì‹ í˜¸ ê²°ì •

7. **ìµœì¢… path ì¶œë ¥**

---

# 3. **ì§€ì›ë˜ëŠ” Scene Modules(í–‰ë™ ëª¨ë“ˆ)**

Behavior Path PlannerëŠ” ì—¬ëŸ¬ ì¥ë©´(scene) ëª¨ë“ˆë¡œ êµ¬ì„±ëœë‹¤.

| ëª¨ë“ˆ                                   | ì„¤ëª…                                |
| ------------------------------------ | --------------------------------- |
| **Lane Following**                   | lanelet centerline ê¸°ë°˜ ì°¨ì„  ìœ ì§€ ê²½ë¡œ ìƒì„± |
| **Static Obstacle Avoidance**        | ì •ì  ì¥ì• ë¬¼ íšŒí”¼ ê²½ë¡œ ìƒì„±                   |
| **Dynamic Obstacle Avoidance (WIP)** | ë™ì  ê°ì²´ íšŒí”¼(ì‘ì—… ì¤‘)                    |
| **Avoidance by Lane Change**         | ì°¨ì„  ë³€ê²½ ê¸°ë°˜ íšŒí”¼                       |
| **Lane Change**                      | ë‹¨ìˆœ ì°¨ì„  ë³€ê²½                          |
| **External Lane Change (WIP)**       | ì™¸ë¶€ ìš”ì²­ ê¸°ë°˜ ì°¨ì„  ë³€ê²½                    |
| **Goal Planner**                     | ì°¨ì„ ì—ì„œ ëª©í‘œê°€ shoulderì— ìˆì„ ë•Œ ëª©í‘œì ìœ¼ë¡œ ì ‘ê·¼  |
| **Start Planner**                    | ì •ì§€ ìƒíƒœ â†’ ë„ë¡œë¡œ í•©ë¥˜                    |
| **Side Shift**                       | ëª…ë ¹ ê¸°ë°˜ ì˜†ìœ¼ë¡œ ì´ë™ (remote ì¡°ì‘ìš©)         |

---

# 4. **Planner Manager â€” ëª¨ë“ˆ ì´ê´„ ê´€ë¦¬ì**

Planner ManagerëŠ” ë‹¤ìŒ ê¸°ëŠ¥ ìˆ˜í–‰:

### 1) ì–´ë–¤ ëª¨ë“ˆì„ í™œì„±í™”í• ì§€ íŒë‹¨

ì˜ˆ:

* ì•ì— ì£¼ì°¨ ì°¨ëŸ‰ â†’ íšŒí”¼ ëª¨ë“ˆ í™œì„±í™”
* ì°¨ì„  ë³€ê²½ í•„ìš” â†’ lane change í™œì„±í™”

### 2) ì—¬ëŸ¬ ëª¨ë“ˆì´ ë™ì‹œì— ì¼œì§€ë©´ ìš°ì„ ìˆœìœ„ ê´€ë¦¬

ì˜ˆ: lane change + avoidanceê°€ ë™ì‹œì— ê°€ëŠ¥í•  ë•Œ ì–´ë–¤ ê²ƒì„ ì“¸ì§€ ê²°ì •.

### 3) ì—¬ëŸ¬ ëª¨ë“ˆì´ ìƒì„±í•œ pathë¥¼ merge

ê²°êµ­ ì°¨ëŸ‰ì´ ë”°ë¼ê°ˆ â€œí•˜ë‚˜ì˜ pathâ€ë¥¼ ìƒì„±í•´ì•¼ í•˜ë¯€ë¡œ í•©ì³ì„œ ì¼ê´€ëœ ê²½ë¡œ ìƒì„±

â€» debugë¥¼ ìœ„í•´ verbose ëª¨ë“œ ì œê³µ

---

# 5. **ì…ë ¥ / ì¶œë ¥ ì¸í„°í˜ì´ìŠ¤**

## ğŸ“¥ **ì…ë ¥ (Input topics)**

| ì´ë¦„                            | í•„ìˆ˜ | íƒ€ì…                     | ì„¤ëª…                          |
| ----------------------------- | -- | ---------------------- | --------------------------- |
| ~/input/odometry              | â—‹  | Odometry               | ego velocity                |
| ~/input/accel                 | â—‹  | AccelWithCov           | ego acceleration            |
| ~/input/objects               | â—‹  | PredictedObjects       | perceptionì˜ dynamic objects |
| ~/input/occupancy_grid_map    | â—‹  | OccupancyGrid          | goal plannerì—ì„œ ì‚¬ìš©           |
| ~/input/traffic_signals       | â—‹  | TrafficLightGroupArray | ì‹ í˜¸ë“± ì¸ì‹                      |
| ~/input/vector_map            | â—‹  | LaneletMapBin          | lanelet ì§€ë„                  |
| ~/input/route                 | â—‹  | LaneletRoute           | ì „ì—­ ê²½ë¡œ                       |
| ~/input/scenario              | â—‹  | Scenario               | í˜„ì¬ ì‹œë‚˜ë¦¬ì˜¤ê°€ LaneDrivingì¸ì§€ íŒë‹¨   |
| ~/input/lateral_offset        | â–³  | LateralOffset          | side shift ì…ë ¥               |
| ~/system/operation_mode/state | â—‹  | OperationModeState     | ììœ¨ ëª¨ë“œ ì—¬ë¶€                    |

---

## ğŸ“¤ **ì¶œë ¥ (Output topics)**

| ì´ë¦„                            | íƒ€ì…                    | ì˜ë¯¸               | QoS             |
| ----------------------------- | --------------------- | ---------------- | --------------- |
| ~/output/path                 | PathWithLaneId        | ìƒì„±ëœ ìµœì¢… ê²½ë¡œ        | volatile        |
| ~/output/turn_indicators_cmd  | TurnIndicatorsCommand | ë°©í–¥ì§€ì‹œë“± ëª…ë ¹         | volatile        |
| ~/output/hazard_lights_cmd    | HazardLightsCommand   | ë¹„ìƒë“± ëª…ë ¹           | volatile        |
| ~/output/modified_goal        | PoseWithUuidStamped   | goal planning ê²°ê³¼ | transient_local |
| ~/output/reroute_availability | RerouteAvailability   | ì¬ë¼ìš°íŒ… ê°€ëŠ¥ ì—¬ë¶€       | volatile        |

---

# 6. **ê°ì¢… Debug í† í”½**

* avoidance_debug_message_array
* lane_change_debug_message_array
* maximum_drivable_area
* turn_signal_info
* bound
* path_candidate/*
* path_reference/*
  â†’ ê° ëª¨ë“ˆì´ ë§Œë“  ê²½ë¡œ/ì°¸ê³ ê²½ë¡œ ë“±ì„ í™•ì¸ ê°€ëŠ¥

---

# 7. **ëª¨ë“ˆ í™œì„±í™” / ë¹„í™œì„±í™” ë°©ë²•**

### ğŸ”§ default_preset.yaml

â†’ ì–´ë–¤ ëª¨ë“ˆì„ ì¼œê³  ëŒì§€ ì„¤ì •í•˜ëŠ” config íŒŒì¼

```yaml
launch_static_obstacle_avoidance_module: true
```

### ğŸ”§ behavior_path_planner.launch.xml

â†’ ìœ„ presetì˜ ê°’ë“¤ì„ ì‹¤ì œ íŒŒë¼ë¯¸í„°ë¡œ ì „ë‹¬

```xml
<param name="static_obstacle_avoidance.enable_module" value="$(var launch_static_obstacle_avoidance_module)"/>
```

ì¦‰ **ê¸°ëŠ¥ì„ ì¼œê³  ë„ë ¤ë©´ default_preset.yamlë§Œ ìˆ˜ì •í•˜ë©´ ëœë‹¤.**

---

# 8. **Path ìƒì„± ë°©ì‹ (Lateral Shift / Constant Jerk)**

Behavior Path PlannerëŠ” **ì°¨ì„  ë³€ê²½Â·íšŒí”¼ì—ì„œ lateral shift ê²½ë¡œë¥¼ ë¶€ë“œëŸ½ê²Œ ë§Œë“¤ê¸° ìœ„í•´ constant jerk profileì„ ì‚¬ìš©**í•œë‹¤.

constant jerk â†’
ê°€ì†ë„ ë³€í™”ëŸ‰(jerk)ì„ ì¼ì •í•˜ê²Œ ìœ ì§€í•˜ì—¬ **ìŠ¹ì°¨ê° â†— ì•ˆì •ì„± â†— ì¡°ì‘ ê±°ë™ ìì—°ìŠ¤ëŸ¬ì›€ â†—**

### í•µì‹¬ ìš”ì†Œ

* lateral displacement(ì˜† ì´ë™ ê±°ë¦¬)
* lateral velocity / acceleration ì†ì„±
* ì°¨ëŸ‰ì˜ ìµœëŒ€ lateral acceleration / jerk ì œí•œ
* total shift time ê³„ì‚°
* ShiftLine êµ¬ì¡°ì²´ ì‚¬ìš© â†’ lateral shift ì‹œì‘/ë index ê´€ë¦¬

---

# 9. **Collision Assessment / Safety Check**

í•µì‹¬ ëª©ì :

### â‘  **í›„ë³´ ê²½ë¡œ ìƒì„± ì¤‘ ì¶©ëŒ ì—¬ë¶€ í‰ê°€**

### â‘¡ **ì´ë¯¸ ì‹¤í–‰ ì¤‘ì¸ ëª¨ë“ˆì´ ì•ˆì „í•œì§€ ì¬ê²€ì‚¬**

ë™ì‘ ë°©ì‹:

1. target ê°ì²´ì˜ ì˜ˆì¸¡ ê²½ë¡œì—ì„œ íŠ¹ì • ì‹œê°„ëŒ€ ìœ„ì¹˜ ë³´ê°„
2. ego polygon vs object polygon overlap ê²€ì‚¬
3. ê²½ë¡œ ìƒ arc lengthë¡œ ì•/ë’¤ ê´€ê³„ íŒë‹¨
4. RSS ê±°ë¦¬ ê¸°ë°˜ ì•ˆì „ì„± ê³„ì‚°

   * reaction time
   * safety margin
   * ego/target ì†ë„
   * ì œë™ë ¥
   * lateral/longitudinal í™•ì¥ polygon ìƒì„±
     â†’ ê²¹ì¹˜ë©´ unsafe

### âš  Yaw angle ë¬¸ì œ

predicted pathì˜ yawê°€ ë‹¤ìŒ pointë¥¼ ë°”ë¼ë³´ì§€ ì•ŠëŠ” ê²½ìš° ì¡´ì¬ â†’ edge caseì—ì„œ ì˜¤ì°¨ ê°€ëŠ¥

---

# 10. **Drivable Area ìƒì„±**

## â‘  Static Drivable Area

* lanelet ê¸°ë°˜
* avoidance module ë™ì‘ ì‹œ ì¶”ê°€ ê³µê°„ í¬í•¨
* track ê²½ê³„/ì°¨ëŸ‰ footprint ê¸°ë°˜ í™•ì¥
* dynamic objects ì œì™¸ ê°€ëŠ¥

## â‘¡ Dynamic Drivable Area

(ëŒ€í˜• ì°¨ëŸ‰, íšŒì „ ë“±ìœ¼ë¡œ ì°¨ì„ ë§Œìœ¼ë¡œëŠ” ë¶ˆì¶©ë¶„í•œ ê²½ìš°)

* ì°¨ëŸ‰ íšŒì „ ë°˜ê²½ ê¸°ë°˜ lane width ë™ì  í™•ì¥
* ì´ì „ ê³„ì‚° ê²°ê³¼ ì¬ì‚¬ìš©í•´ CPU ì ˆì•½
* path curvature ê¸°ë°˜ boundary ì¡°ì •
* ê¸‰ê²©íˆ ë³€í•˜ì§€ ì•Šë„ë¡ expansion rate ì œí•œ

---

# 11. **Turn Signal ìƒì„±**

TurnIndicatorsCommand ì‚¬ìš©.

turn signalì€ ë‹¤ìŒ ë‘ ê°€ì§€ë¡œ êµ¬ë¶„:

### âœ” Desired turn signal

ì¼ë°˜ ì£¼í–‰ ê·œì¹™(ë²•ê·œ)ì— ë”°ë¼ â€œì¼œëŠ” ê²ƒì´ ë°”ëŒì§í•œâ€ ê²½ìš°

### âœ” Required turn signal

ì•ˆì „ìƒ ë°˜ë“œì‹œ í•„ìš”(ê¸‰ì°¨ì„  ë³€ê²½ ë“±)

ì¶œë ¥ ê°’:

| ID           | ì˜ë¯¸       |
| ------------ | -------- |
| NO_COMMAND   | ì‹ í˜¸ í•„ìš” ì—†ìŒ |
| DISABLE      | ë¹„í™œì„±      |
| ENABLE_LEFT  | ì¢Œì¸¡ ê¹œë¹¡ì´   |
| ENABLE_RIGHT | ìš°ì¸¡ ê¹œë¹¡ì´   |

---

# 12. **Rerouting (ê°œë°œ ì¤‘)**

ì¬ë¼ìš°íŒ… ê¸°ëŠ¥ì€ ì•„ì§ ê°œë°œ ì§„í–‰ ì¤‘.

---

# 13. **íŒŒì¼ êµ¬ì¡°(íŒŒë¼ë¯¸í„° ê´€ë¦¬)**

behavior_path_planner í´ë”ì—ëŠ” ë‹¤ìŒê³¼ ê°™ì€ íŒŒë¼ë¯¸í„°ë“¤ì´ ìˆë‹¤:

```
behavior_path_planner
â”œâ”€â”€ behavior_path_planner.param.yaml
â”œâ”€â”€ drivable_area_expansion.param.yaml
â”œâ”€â”€ scene_module_manager.param.yaml
â”œâ”€â”€ static_obstacle_avoidance/
â”œâ”€â”€ avoidance_by_lc/
â”œâ”€â”€ dynamic_obstacle_avoidance/
â”œâ”€â”€ goal_planner/
â”œâ”€â”€ lane_change/
â”œâ”€â”€ side_shift/
â””â”€â”€ start_planner/
```

ê³µí†µ íŒŒë¼ë¯¸í„°ëŠ” common ë””ë ‰í† ë¦¬ì— ì¡´ì¬:

```
common
â”œâ”€â”€ common.param.yaml
â”œâ”€â”€ costmap_generator.param.yaml
â””â”€â”€ nearest_search.param.yaml
```

presetì€ default_preset.yamlë¡œ ëª¨ë“ˆ í™œì„±í™” ê´€ë¦¬:

```
preset
â””â”€â”€ default_preset.yaml
```

---

# 14. **Limitations & Future Work**

* Goal plannerëŠ” ë‹¤ë¥¸ ëª¨ë“ˆê³¼ ë³‘í–‰ ì‹¤í–‰í•  ìˆ˜ ì—†ìŒ.
* Plugin êµ¬ì¡°ê°€ ì•„ë‹ˆê¸° ë•Œë¬¸ì— ìƒˆë¡œìš´ ì»¤ìŠ¤í…€ ëª¨ë“ˆì„ ì¶”ê°€í•˜ê¸° ì–´ë ¤ì›€
  â†’ Behavior Path Planner ë³¸ ì½”ë“œ ì¼ë¶€ ìˆ˜ì • í•„ìš”.

---

# ğŸ“Œ ê²°ë¡ : Behavior Path PlannerëŠ” Autowareì˜ â€œì£¼í–‰ ì˜ì‚¬ê²°ì • + Path ìƒì„±â€ì˜ í•µì‹¬

Autowareì—ì„œ Behavior Path PlannerëŠ”:

* ë„ë¡œ êµ¬ì¡°
* ë™ì /ì •ì  ì¥ì• ë¬¼
* êµí†µ ê·œì¹™
* ego ìƒíƒœ
* ì•ˆì „ / ê²½ë¡œ ë¶€ë“œëŸ¬ì›€
  ì„ ê¸°ë°˜ìœ¼ë¡œ, ì£¼í–‰ í–‰ë™ì„ ê²°ì •í•˜ê³  pathë¥¼ ë§Œë“œëŠ” **ì¤‘ì¶”ì  ëª¨ë“ˆ**ì´ë‹¤.

ê·¸ë¦¬ê³  path ìƒì„±ë¿ ì•„ë‹ˆë¼:

* ì¶©ëŒ ê²€ì‚¬
* ì£¼í–‰ ê°€ëŠ¥ ì˜ì—­ ì •ì˜
* ë°©í–¥ì§€ì‹œë“± ì¶œë ¥
  ê¹Œì§€ ëª¨ë‘ ë‹´ë‹¹í•œë‹¤ëŠ” ì ì—ì„œ **ë¡œì»¬ ë ˆë²¨ì˜ Behavior + Path Planningì„ ì´ê´„í•˜ëŠ” ì—”ì§„**ì´ë¼ê³  ë³´ë©´ ëœë‹¤.

---

ì›í•˜ëŠ” ê²½ìš° ì•„ë˜ë„ ë§Œë“¤ì–´ì¤„ ìˆ˜ ìˆì–´:

âœ… Behavior Path Planner ì „ì²´ êµ¬ì¡° ë„ì‹
âœ… ForzaETH race_stackì˜ Spliner / L1 Controller / Particle Filterì™€ Autoware Behavior Path Planner êµ¬ì¡° ë¹„êµ
(ì´ë¯¸ ì—¬ëŸ¬ ë²ˆ ìš”ì²­í–ˆìœ¼ë‹ˆ ë‚´ê°€ ìë™ìœ¼ë¡œ ë§¤ì¹­ ê°€ëŠ¥)
âœ… Behavior Path Planner ì „ì²´ë¥¼ **ForzaETH ê¸°ì¤€ìœ¼ë¡œ ì¬ì •ë¦¬í•œ ë²„ì „**
âœ… Behavior Path Plannerì˜ â€œPath Generation / Collision Checkingâ€ ìˆ˜ì‹ ì‰½ê²Œ ì„¤ëª…
âœ… Autoware â†’ F1TENTH ì ìš© ì‹œ ì–´ë–¤ ëª¨ë“ˆì´ ëŒ€ì‘ë˜ëŠ”ì§€ ë§¤í•‘

í•„ìš”í•œ í˜•íƒœ ì•Œë ¤ì¤˜!
